import{bV as I,a as h,j as e,e as f,r as N,bW as W,$ as j,T as x,b as S,V as F,W as B,X as P,Y as A,Z as p,a0 as q,a1 as z,I as O,a3 as U,g as V,k as y}from"./strapi-BPdQaMbf.js";import{W as d}from"./WidgetHelpers-0xGsjP4e.js";const G=I.enhanceEndpoints({addTagTypes:["RecentDocumentList","CountDocuments"]}).injectEndpoints({overrideExisting:!0,endpoints:s=>({getRecentDocuments:s.query({query:t=>`/content-manager/homepage/recent-documents?action=${t.action}`,transformResponse:t=>t.data,providesTags:(t,r,{action:l})=>[{type:"RecentDocumentList",id:l}]}),getCountDocuments:s.query({query:()=>"/content-manager/homepage/count-documents",transformResponse:t=>t.data,providesTags:(t,r)=>["CountDocuments"]})})}),{useGetRecentDocumentsQuery:D,useGetCountDocumentsQuery:H}=G,M=y(x).attrs({maxWidth:"14.4rem",display:"block"})`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,$=({documents:s})=>{const{formatMessage:t}=h(),{trackUsage:r}=S(),l=F(),i=n=>{const c=n.kind==="singleType",m=c?"single-types":"collection-types",b=n.locale?`?plugins[i18n][locale]=${n.locale}`:"";return`/content-manager/${m}/${n.contentTypeUid}${c?"":"/"+n.documentId}${b}`},u=n=>()=>{r("willEditEntryFromHome");const c=i(n);l(c)};return e.jsx(B,{colCount:5,rowCount:s?.length??0,children:e.jsx(P,{children:s?.map(n=>e.jsxs(A,{onClick:u(n),cursor:"pointer",children:[e.jsx(p,{children:e.jsx(M,{title:n.title,variant:"omega",textColor:"neutral800",children:n.title})}),e.jsx(p,{children:e.jsx(M,{variant:"omega",textColor:"neutral600",children:n.kind==="singleType"?t({id:"content-manager.widget.last-edited.single-type",defaultMessage:"Single-Type"}):t({id:n.contentTypeDisplayName,defaultMessage:n.contentTypeDisplayName})})}),e.jsx(p,{children:e.jsx(j,{display:"inline-block",children:n.status?e.jsx(q,{status:n.status}):e.jsx(x,{textColor:"neutral600","aria-hidden":!0,children:"-"})})}),e.jsx(p,{children:e.jsx(x,{textColor:"neutral600",children:e.jsx(z,{timestamp:new Date(n.updatedAt)})})}),e.jsx(p,{onClick:c=>c.stopPropagation(),children:e.jsx(j,{display:"inline-block",children:e.jsx(O,{tag:U,to:i(n),onClick:()=>r("willEditEntryFromHome"),label:t({id:"content-manager.actions.edit.label",defaultMessage:"Edit"}),variant:"ghost",children:e.jsx(V,{})})})})]},n.documentId))})})},Z=()=>{const{formatMessage:s}=h(),{data:t,isLoading:r,error:l}=D({action:"update"});return r?e.jsx(d.Loading,{}):l||!t?e.jsx(d.Error,{}):t.length===0?e.jsx(d.NoData,{children:s({id:"content-manager.widget.last-edited.no-data",defaultMessage:"No edited entries"})}):e.jsx($,{documents:t})},J=()=>{const{formatMessage:s}=h(),{data:t,isLoading:r,error:l}=D({action:"publish"});return r?e.jsx(d.Loading,{}):l||!t?e.jsx(d.Error,{}):t.length===0?e.jsx(d.NoData,{children:s({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})}):e.jsx($,{documents:t})},o=80,w=10,T=2*Math.PI*(o-w/2),_=y.circle`
  stroke: ${({theme:s,$arcColor:t})=>s.colors[t]};
`,k=y.tspan`
  text-transform: lowercase;
  fill: ${({theme:s,$textColor:t})=>s.colors[t]};
`,K=y(f)`
  width: 100%;

  ${({theme:s})=>s.breakpoints.small} {
    width: auto;
  }
`,Q=({data:s})=>{const{locale:t}=h(),{formatMessage:r}=h(),l=s.reduce((a,g)=>a+g.count,0),[i,u]=N.useState({visible:!1,x:0,y:0,value:null});let n=0;const c=(a,g)=>{u({visible:!0,x:a.clientX,y:a.clientY,value:g})},m=()=>{u(a=>({...a,visible:!1}))},b=(a,g)=>{u({visible:!0,x:a.currentTarget.getBoundingClientRect().width/2+a.currentTarget.getBoundingClientRect().left,y:a.currentTarget.getBoundingClientRect().height+a.currentTarget.getBoundingClientRect().top,value:g})};return e.jsxs(f,{direction:"column",gap:6,margin:"auto",children:[e.jsxs("svg",{width:o*2,height:o*2,viewBox:`0 0 ${o*2} ${o*2}`,style:{position:"relative",zIndex:1},children:[e.jsx("g",{transform:`rotate(-90 ${o} ${o})`,children:s.map(a=>{const g=a.count/l*100,v=g/100*T,R=`${v} ${T-v}`,E=T*(1-n/100),L=e.jsx(_,{cx:o,cy:o,r:o-w/2,fill:"none",strokeWidth:w,strokeDasharray:R,strokeDashoffset:E,style:{transition:"stroke-dashoffset 0.3s",cursor:"pointer"},tabIndex:0,"aria-describedby":i.visible?"chart-tooltip":void 0,onFocus:C=>b(C,a),onBlur:m,onMouseMove:C=>c(C,a),onMouseLeave:m,$arcColor:a.color},a.label);return n+=g,L})}),e.jsxs("text",{x:o,y:o,textAnchor:"middle",fontSize:"2.4rem",fontWeight:"bold",children:[e.jsx(k,{x:o,dy:"0",$textColor:"neutral800",children:new Intl.NumberFormat(t,{notation:"compact",maximumFractionDigits:1}).format(l)}),e.jsx(k,{x:o,dy:"1.4em",fontSize:"1.4rem",fontWeight:"normal",$textColor:"neutral600",children:r({id:"content-manager.widget.chart-entries.title",defaultMessage:"entries"})})]})]}),i.visible&&i.value&&e.jsx(W,{style:{position:"fixed",left:16,top:16,zIndex:2,transform:`translate(${i.x}px, ${i.y}px)`},"data-testid":"entries-chart-tooltip",children:e.jsx(j,{background:"neutral900",padding:2,borderRadius:1,textAlign:"center",role:"tooltip","aria-live":"polite",children:e.jsx(x,{textColor:"neutral0",children:r({id:"content-manager.widget.chart-entries.tooltip",defaultMessage:"{count} items"},{count:i.value.count,label:i.value.label})})})}),e.jsx(f,{gap:4,wrap:"wrap",children:s.map(a=>a.count>0&&e.jsxs(K,{gap:1,children:[e.jsx(j,{background:a.color,padding:2,borderRadius:1}),e.jsx(x,{variant:"pi",children:a.label})]},a.label))})]})},ee=()=>{const{formatMessage:s}=h(),{data:t,isLoading:r,error:l}=H();if(r)return e.jsx(d.Loading,{});if(l)return e.jsx(d.Error,{});const{draft:i,published:u,modified:n}=t??{draft:0,published:0,modified:0};return i+u+n?e.jsx(f,{minHeight:"100%",children:e.jsx(Q,{data:[{label:s({id:"content-manager.containers.List.draft",defaultMessage:"Draft"}),count:i,color:"secondary500"},{label:s({id:"content-manager.containers.List.modified",defaultMessage:"Modified"}),count:n,color:"alternative500"},{label:s({id:"content-manager.containers.List.published",defaultMessage:"Published"}),count:u,color:"success500"}]})}):e.jsx(d.NoData,{children:s({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})})};export{ee as ChartEntriesWidget,Z as LastEditedWidget,J as LastPublishedWidget};
